<?php
defined('BASEPATH') OR exit('No direct script access allowed');
class Plages_horaire extends CI_Controller
{
	 public function __construct()
    {
        parent::__construct();
         $this->load->model('plages_horaire_model');
        $this->load->view('theme/header');
    }
    public function index()
    {
    	if (null!==($this->session->userdata('identifiant'))) {
             // si on a une session avec identifiant d'ouverte
             $data=array();
             $data['liste_plages_horaire']=$this->plages_horaire_model->listing_plages_horaire();
             // on détermine si l'user a déjà une plage horaire en cours , sinon on l'invite à en créer une
             $this->load->view('plages_horaire/liste_plages_horaire',$data);
            
        }
        else
        {
            redirect('login');
        }
    }
    public function creation_plages_horaire()
    {
        $this->load->view('plages_horaire/creation_plages_horaire');
    }
    public function insertion_plages_horaire()
    {
        $heure_debut=$this->input->post('heure_debut');
        $heure_fin=$this->input->post('heure_fin');
        $nom=$this->input->post('nom');
        if ($nom <> '' ) {
            $this->plages_horaire_model->insertion_plages_horaire($heure_debut,$heure_fin,$nom);
            redirect('plages_horaire');
        }
        else {
            //todo : popup pour dire qu'ilf aut mettre le nom avec
            redirect('plages_horaire/creation_plages_horaire');
        }
        
    
    }
    public function supprimer_plages_horaire($id)
    {
        //suppression de la plage horaire
        $this->plages_horaire_model->suppression_plages_horaire($id);
        redirect('plages_horaire');
    }
     public function modif_plages_horaire($id)
    {
        $data=array();
        $data['infos_plages_horaire']=$this->plages_horaire_model->infos_plages_horaire($id);
        $this->load->view('plages_horaire/infos_plages_horaire',$data);
    }
    public function validation_modif_plages_horaires($id)
    {//recupère les infos du formulaire via post et l'id via get, puis on envoie vers model qui fait un update sur bdd
        $heure_debut=$this->input->post('heure_debut');
        $heure_fin=$this->input->post('heure_fin');
        $nom=$this->input->post('nom');
        
         $this->plages_horaire_model->maj_plages_horaire($heure_debut,$heure_fin,$nom,$id);
        redirect('plages_horaire');
        
    }
   
   
}