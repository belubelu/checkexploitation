<title>Aperçu option21</title>
<body>
	<div class="row ">
		<h2 class="col-lg-3">Planification d'option 21</h2>
		<a class="btn btn-info" href="<?php echo base_url('index.php/option21/planification');?>"><i class="far fa-calendar-alt"></i> Planifier une option 21</a>
		<h2 class="col-lg-3 offset-lg-2">Option 21 en cours</h2>
		</div>
	<div class="row">
		<table class="col-lg-4 table table-bordered table-striped table-sm">
			<thead class="thead-dark">
				<tr>
					<th>Numéro option21</th>
					<th>Jeu de cartouche</th>
					<th>Utilisateur</th>
					<th>Machines</th>
					<th>Statut</th>
					<th>Date de planification</th>
					<th>Actions </th>
					<th>Supprimer</th>
				</tr>
			</thead>
			<tr>
				<?php
			
			foreach ($liste_option21 as $option21) // on récupère les infos de la bdd via selecte et on les utilise via un foreach poour les parcourir
			{?>
				<tr>
					<td>
						<?= $option21->id_opt21 ?>
					</td>
					<td>
						<?= $option21->jeu ?>
					</td>
					<td>
						<?= $option21->nom ?>
						(<?= $option21->identifiant ?>)
					</td>
					<td>
						<?= $option21->nom_dns ?>
					</td>
					<td>
						<?php // au lieu d'avoir juste statu P ou autre, je transforme pour que ce soi plus parlant
							$statut=$option21->statut;
							 switch ($statut)
			                {
			                    case 'p':
			                        $statut='Planifié';
			                        break;
			                    case 't':
			                        $statut='Terminé';
			                        break;
			                    case 'e':
			                        $statut='Erreur';
			                        break;
			                    case 'c':
			                        $statut='En cours';
			                        break;
			                    default:
			                        $statut='En erreur';
			                        break;
			                }
			                echo $statut;
							 ?>
					</td>
					<td>
						<?= $option21->date_planification ?>
					</td>
					<td>
						<a class="btn btn-info" id="<?= $option21->id_opt21?>" href="<?= base_url('index.php/option21/start_option21/'.$option21->id_opt21)?>"><i class="fas fa-caret-square-right"></i> Démarrer</a>
					</td>
					<td>
						<a class="btn btn-danger "href="<?= base_url('index.php/option21/supprimer_option21/'.$option21->id_opt21)?>" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cette option 21 ?');"><i class="far fa-trash-alt"></i> Supprimer</a>
					</td>
					
				</tr>
			<?php 
			unset($option21);}
				
					
		?>
			</tr>
		<!--  on récupère les données de la bdd via le select du model et on utilise un foreach pour les parcourir -->
		</table>
		<table class="col-lg-6 offset-1 table table-hover table-bordered table-striped table-sm  " id="tab-en-cours">
			<thead class="thead-dark">
				<tr>
					<th>Machines</th>
					<th>Jeu de cartouche</th>
					<th>Utilisateur</th>
					<th>Statut</th>
					<th>Date de début</th>
					<th colspan="2">Actions </th>
					<th>Commentaire</th>
					
				</tr>
			</thead>
			<tr>
				<?php
			$i=0;
			foreach ($en_cours as $option21) // on récupère les infos de la bdd via selecte et on les utilise via un foreach poour les parcourir
			{?>
				<tr class="ligne">
					<td>
						<?= $option21->nom_dns ?>
					</td>
					<td>
						<?= $option21->jeu ?>
					</td>
					<td>
						<?= $option21->nom ?>
						(<?= $option21->identifiant ?>)
					</td>
					<td>
						<?php // au lieu d'avoir juste statu P ou autre, je transforme pour que ce soi plus parlant
							$statut=$option21->statut;
							 switch ($statut)
			                {
			                    case 'p':
			                        $statut='Planifié';
			                        break;
			                    case 't':
			                        $statut='Terminé';
			                        break;
			                    case 'e':
			                        $statut='Erreur';
			                        break;
			                    case 'c':
			                        $statut='En cours';
			                        break;
			                    default:
			                        $statut='En erreur';
			                        break;
			                }
			                echo $statut;
							 ?>
					</td>
					<td>
						<?= $option21->date_debut ?>
					</td>
					<td>
						<?php echo form_open('option21/fin_option21/'.$option21->id_opt21, '  id="fin_option21"'); ?>
						<button type="submit" class="btn btn-success" name="bOK"><i class="fas fa-check"></i> OK</button>
						<input type="hidden" name="id_machines" value="<?= $option21->id_machines ?>">
					</td>
					<td>						
						<button type="submit" class="btn btn-warning" name="berreur"><i class="fas fa-exclamation-triangle"></i> Erreur</button>
					</td>
					<td>
						<textarea name="commentaire" class="form-control"  rows="3" ></textarea>
						<?= form_close(); ?>
					</td>
					
				</tr>

			<?php 
			unset($option21);
			$i++;
		}		
		?>
			</tr>
		<!--  on récupère les données de la bdd via le select du model et on utilise un foreach pour les parcourir -->
		</table>

	</div>
	<script src="<?= base_url('assets/javascript/jq-commentaire.js')?>"></script>
</body>